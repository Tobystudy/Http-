#  웹 중재자

- 프록시는 클라이언트이면서 서버

## 개인 프록시와 공유 프록시

- 하나의 클라이언트가 독점적으로 사용할수도 있고, 공유될 수도 있음
- 대부분은 공유 프록시형태

## vs 게이트 웨이

- 엄밀한 정의는 프록시는 프로토콜 컨버팅 기능. 프로토콜을 컨버팅해준다면 이는 게이트웨이에 해당

- 실무에서는 항상 그렇지만, 각 레이어별로 여러 역할을 수행할수 있고, 책임과 역할 분리의 애매함때문에 게이트웨이와 프록시의 경계가 모호하다

# 왜 프록시를 사용하는가?

- 실용적이고 유용한건 어떤것이든 수행
- 보안, 성능, 비용 등등 다양한 이유
- 리버스 프록시, 대리 프록시 : 보통 이표현을 쓸때는 간단한 게이트웨이 겸 서버 라우터용 
- 트랜스 코딩역할도 수행하기도함 gif -> jpg 처럼 성능 최적화 목적으로 컨버팅

# 프록시는 어디에 있는가?

- 배치는 어디든 가능! 출구 / 입구 / 서버 바로앞단 등등

## 프록시의 계층 표현

- 서버에 가까울경우 부모로 표현
- 클라에 가까울경우 자식으로 표현
 
(클라) -- (프록시1) -- (프록시2) -- (프록시3) -- (서버)

이라면 프록시 3이 부모이며 인바운드 프록시, 프록시1은 자식이며 아웃바운드 프록시

- 상황에 맞게 라우팅도 가능

## 어떻게 프록시가 트래픽을 처리하는가

- 클라이언트가 의도적으로 프록시로 요청하기
- 인터셉트 프록시를 이용해 가로채기
- DNS 수정으로 대리 프록시가 웹서버의 이름과 ip 주소 사용
- 웹 서버가 리아디렉션으로 프록시를 통하도록 유도

## 클라이언트 프록시
- 익명성 제공
- 보안 목적
- 접근 제한 등 목적

### proxy auto-configuration PAC

- 프록시를 탈건지 자동으로 판단하는 로직이 담겨잇음

### WPAD
 웹 프록시 자동 발견 프로토콜로 pac 를 찾는 알고리즘

# 프락시 요청의 미묘한 특징들

## 프락시 uri는 서버 uri와 다르다
- 서버 uri는 일반적으로 부분 uri로 통신하고 받아들이는 경우가 많음
- 브라우저 입장에서 이런 서버 uri접근은 사실상 불가능하므로 풀 uri를 가진 프록시를 통해 대리로 접속해야할 경우가 많다
- 따라서 프록시는 부분 uri / 완전uri에 대한 리졸브와 핸들링을 모두 할수 있는경우가 많다
- 프록시는 uri 변경은 최소화한다. 프로토콜 경찰 역할이 아님!


# 메시지 추적

- 프록시를 넘나들때 추적은 어떻게하지?

## Via 헤더

- 프록시들의 정보를 나열, 메시지가 지나는 모든 경로를 추가하는 방식
- 프로토콜 변환시 해당 행위도 기록
- 보안목적으로 가공될수 있지만, 극히 예외적이며 일반적으로는 유지되어야함

## TRACE 메서드
- 서버 사이드에서 막혀있는경우가 많은데 가능할까?

# 프락시 인증

- 407 Proxy Authorization Required 프록시 인증 제어 상태 코드가 있다

# 프락시 상호운용성

- 프락시는 자신이 이해하지 못하는 헤더를 반드시 전달해야함
- 상대적인 순서도 유지해야함

전체적으로 프록시가 지켜야할 룰과 구현 패턴들이라 프록시를 구현할때 다시 한번 참고하면 될듯. 당장 공부할거는 없어보인다.
