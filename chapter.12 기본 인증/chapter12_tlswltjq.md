# 기본인증
많은 사용자, 많은 데이터.
리소스는 개인화 되어간다.
이제 서버는 사용자가 누구인지 식별하고 어떤 리소스에 접근 가능한지 알 수 있어야한다.
이 장에서 HTTP인증과 그 기본이 되는 기본 인증을 알아본다.
## 인증
인증이란 내가 누구인지 증명하는것이다.
완벽한 인증이란 없다, 누군가 내 인증정보를 탈취할 수 있다.

#### 인증요구/ 응답의 과정
요청 -> 인증요구 -> 인가 -> 성공
1. 문서요청 : 사용자는 클라이언트를 통해 문서를 요청한다.
2. 인증요구 : 인증이 필요한 문서인 경우 서버는 인증을 요구한다.
   사용자는 클라이언트를 통해 인증정보를 전달한다 (ex)id/pw)
3. 인가 : 올바른 인증정보를 전달하면 서버는 문서에대한 접근(요청)을 허용한다.
5. 성공 : 사용자는 클라이언트를 통해 문서에 접근할 수 있다.
이 과정에서 아래 와같은 헤더를 포함한다.

| 단계   | 헤더                  | 설명                                        | 메서드 / 상태         |
| ---- | ------------------- | ----------------------------------------- | ---------------- |
| 요청   |                     | 요청시엔 인증정보 없음                              | GET              |
| 인증요구 | WWW-Authenticate    | 이름과 비밀번호를 제공하라는 의미로 401과 함께 요청 반려         | 401 Unauthorized |
| 인증   | Authorization       | 이름과 비밀번호를 기술한 Authorization 헤더를 함께 담아 재요청 | GET              |
| 성공   | Authentication-Info | 인증정보가 정확하면 문서와 함께 응답                      | 200 OK           |
## 기본 인증
기본인증 = ID, PW를이용한 로그인
기본인증은 base64인코딩을 거친후 Authorization헤더에 담겨 전송된다.
인코딩일뿐 암호화가 아니기에 여전히 위험에 노출되어있다.
### 프락시를 이용한 인증
서버에 접근하기위해 프락시를 거치도록 한다. 프락시에 접근정책을 중앙화 하여 관리할 수 있다.
인증 절차는 같으며 헤더와 상태코드만 다르다.

| 웹 서버                | 프락시 서버                    |
| ------------------- | ------------------------- |
| 비인증 상태코드 : 401      | 비인증 상태코드 : 407            |
| WWW-Authenticate    | Proxy-Authenticate        |
| Authorization       | Proxy-Authorization       |
| Authentication-Info | Proxy-Authentication-Info |
## 기본 인증의 보안 결함
1. 디코딩하기쉽다.
2. 더욱 복잡하게 인코딩하더라도 캡쳐해 그대로 서버에 인증을 요청할 수 있다.
3. 치명적이지 않은 리소스에 대한 보안이 뚫리는것은 단 하나의 리소스에대한 문제가 아니다. 다른 리소스에도 접근을 시도해 볼 수 있고 충분히 뚫릴 가능성이 있다.
4. 인증헤더 이외의 헤더를 수정해 트랜잭션의 의도를 바꿔버릴 수 있다.
5. 기본인증 방식은 가짜서버에 취약하다. 가짜 서버, 가짜 게이트웨이에 연결되어 있다면 비밀번호를 요청해 수집하고 에러를 보여주는 연기를 할 수 있다.
